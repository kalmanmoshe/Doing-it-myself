import { isOperatorWithAssociativity, searchAllMathJaxOperatorsAndSymbols, searchMathJaxOperators, searchTikzComponents } from "./staticData/dataManager";
class BasicToken {
    type;
    value;
    constructor(type, value) {
        if (type)
            this.type = type;
        if (value)
            this.value = value;
    }
    getType() { return this.type; }
    getValue() { return this.value; }
    getNumberValue() { return this.value; }
    getStringValue() { return this.value; }
    setValue(value) { this.value = value; }
    isValueString() { return typeof this.value === 'string'; }
}
export class BasicMathJaxToken extends BasicToken {
    constructor(type, value) {
        super(type, value);
    }
    getStringValue() {
        return this.value;
    }
    getLatexSymbol() {
        return typeof this.value === "string"
            ? searchMathJaxOperators(this.value)?.latex
            : undefined;
    }
    getFullType() {
        return this.type;
    }
    static create(value) {
        if (typeof value === "string") {
            const operator = searchAllMathJaxOperatorsAndSymbols(value);
            if (operator) {
                return new BasicMathJaxToken(/[\(\)]/.test(value) ? 'bracket' : 'operator', operator.name);
            }
            return new BasicMathJaxToken('variable', value);
        }
        return new BasicMathJaxToken('number', value);
    }
    clone() { return new BasicMathJaxToken(this.type || "", this.value); }
    isValueToken() {
        return this.type === "variable" || this.type === "number";
    }
    toStringLatex() {
        let latexString = "";
        if (this.isValueString()) {
            latexString += this.getLatexSymbol() || "";
        }
        if (this.type === "number") {
            latexString += this.value;
        }
        return latexString;
    }
    affectedOperatorRange(direction) {
        if (this.type !== "operator" || this.value === "Equals") {
            return false;
        }
        if (typeof this.value === "string" &&
            direction === "left" &&
            !isOperatorWithAssociativity(this.value, [-1, 1], true)) {
            return false;
        }
        return true;
    }
}
export class BasicTikzToken extends BasicToken {
    constructor(type, value) {
        super(type, value);
    }
    getStringValue() {
        return this.value;
    }
    setValue(value) {
        this.value = value;
    }
    getNumberValue() {
        return this.value;
    }
    static create(value) {
        const token = new BasicTikzToken();
        if (typeof value === "number") {
            token.type = "number";
            token.value = value;
        }
        else if (typeof value === "string") {
            const tikzCommand = searchTikzComponents(value);
            if (tikzCommand) {
                token.type = tikzCommand.type.replace(/Bracket/, "Syntax");
                token.value = tikzCommand.name;
            }
        }
        return token;
    }
    clone() { return new BasicTikzToken(this.type, this.value); }
    toString() {
        if (typeof this.value === "number") {
            return this.getNumberValue().toString();
        }
        const component = searchTikzComponents(this.value);
        if (component && component.latex) {
            return component.latex;
        }
        return this.value;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWNUb2tlbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iYXNpY1Rva2VuLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxtQ0FBbUMsRUFBRSxzQkFBc0IsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRTFKLE1BQU0sVUFBVTtJQUNGLElBQUksQ0FBUztJQUNiLEtBQUssQ0FBa0I7SUFFakMsWUFBWSxJQUFhLEVBQUUsS0FBdUI7UUFDOUMsSUFBSSxJQUFJO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDM0IsSUFBSSxLQUFLO1lBQUUsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7SUFDbEMsQ0FBQztJQUNELE9BQU8sS0FBRyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUEsQ0FBQSxDQUFDO0lBQzNCLFFBQVEsS0FBRyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQSxDQUFDO0lBQzdCLGNBQWMsS0FBRyxPQUFPLElBQUksQ0FBQyxLQUFlLENBQUEsQ0FBQSxDQUFDO0lBQzdDLGNBQWMsS0FBRyxPQUFPLElBQUksQ0FBQyxLQUFlLENBQUEsQ0FBQSxDQUFDO0lBQzdDLFFBQVEsQ0FBQyxLQUFvQixJQUFFLElBQUksQ0FBQyxLQUFLLEdBQUMsS0FBSyxDQUFBLENBQUEsQ0FBQztJQUNoRCxhQUFhLEtBQWdDLE9BQU8sT0FBTyxJQUFJLENBQUMsS0FBSyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUM7Q0FDeEY7QUFFRCxNQUFNLE9BQU8saUJBQWtCLFNBQVEsVUFBVTtJQUM3QyxZQUFZLElBQVksRUFBRSxLQUFzQjtRQUM1QyxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7SUFHRCxjQUFjO1FBQ1YsT0FBTyxJQUFJLENBQUMsS0FBZSxDQUFDO0lBQ2hDLENBQUM7SUFFRCxjQUFjO1FBQ1Ys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QUFDO1lBQzVCLEtBQUssQ0FBQyxJQUFJLEdBQUcsUUFBUSxDQUFDO1lBQ3RCLEtBQUssQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1lBQ25DLE1BQU0sV0FBVyxHQUFHLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hELElBQUksV0FBVyxFQUFFLENBQUM7Z0JBQ2QsS0FBSyxDQUFDLElBQUksR0FBRyxXQUFXLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7Z0JBQzNELEtBQUssQ0FBQyxLQUFLLEdBQUcsV0FBVyxDQUFDLElBQUksQ0FBQztZQUNuQyxDQUFDO1FBQ0wsQ0FBQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxLQUFLLEtBQW9CLE9BQU8sSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQSxDQUFDO0lBRTNFLFFBQVE7UUFDSixJQUFJLE9BQU8sSUFBSSxDQUFDLEtBQUssS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUNqQyxPQUFPLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUM1QyxDQUFDO1FBQ0QsTUFBTSxTQUFTLEdBQUcsb0JBQW9CLENBQUMsSUFBSSxDQUFDLEtBQWUsQ0FBQyxDQUFDO1FBQzdELElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUMvQixPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUM7UUFDM0IsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDLEtBQWUsQ0FBQztJQUNoQyxDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc09wZXJhdG9yV2l0aEFzc29jaWF0aXZpdHksIHNlYXJjaEFsbE1hdGhKYXhPcGVyYXRvcnNBbmRTeW1ib2xzLCBzZWFyY2hNYXRoSmF4T3BlcmF0b3JzLCBzZWFyY2hUaWt6Q29tcG9uZW50cyB9IGZyb20gXCIuL3N0YXRpY0RhdGEvZGF0YU1hbmFnZXJcIjtcblxuY2xhc3MgQmFzaWNUb2tlbiB7XG4gICAgcHJvdGVjdGVkIHR5cGU6IHN0cmluZztcbiAgICBwcm90ZWN0ZWQgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHR5cGU/OiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nIHwgbnVtYmVyKSB7XG4gICAgICAgIGlmICh0eXBlKSB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICBpZiAodmFsdWUpIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0VHlwZSgpe3JldHVybiB0aGlzLnR5cGV9XG4gICAgZ2V0VmFsdWUoKXtyZXR1cm4gdGhpcy52YWx1ZX1cbiAgICBnZXROdW1iZXJWYWx1ZSgpe3JldHVybiB0aGlzLnZhbHVlIGFzIG51bWJlcn1cbiAgICBnZXRTdHJpbmdWYWx1ZSgpe3JldHVybiB0aGlzLnZhbHVlIGFzIHN0cmluZ31cbiAgICBzZXRWYWx1ZSh2YWx1ZTogbnVtYmVyfHN0cmluZyl7dGhpcy52YWx1ZT12YWx1ZX1cbiAgICBpc1ZhbHVlU3RyaW5nKCk6IHRoaXMgaXMgeyB2YWx1ZTogc3RyaW5nIH0geyByZXR1cm4gdHlwZW9mIHRoaXMudmFsdWUgPT09ICdzdHJpbmcnOyB9XG59XG5cbmV4cG9ydCBjbGFzcyBCYXNpY01hdGhKYXhUb2tlbiBleHRlbmRzIEJhc2ljVG9rZW4ge1xuICAgIGNvbnN0cnVjdG9yKHR5cGU6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IG51bWJlcikge1xuICAgICAgICBzdXBlcih0eXBlLCB2YWx1ZSk7XG4gICAgfVxuXG5cbiAgICBnZXRTdHJpbmdWYWx1ZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZSBhcyBzdHJpbmc7XG4gICAgfVxuXG4gICAgZ2V0TGF0ZXhTeW1ib2woKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB0aGlzLnZhbHVlID09PSBcInN0cmluZ1wiXG4gICAgICAgICAgICA/IHNlYXJjaE1hdGhKYXhPcGVyYXRvcnModGhpcy52YWx1ZSk/LmxhdGV4XG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBnZXRGdWxsVHlwZSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlO1xuICAgIH1cbiAgICBzdGF0aWMgY3JlYXRlKHZhbHVlOiBzdHJpbmd8bnVtYmVyKXtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgY29uc3Qgb3BlcmF0b3IgPSBzZWFyY2hBbGxNYXRoSmF4T3BlcmF0b3JzQW5kU3ltYm9scyh2YWx1ZSlcbiAgICAgICAgICAgIGlmIChvcGVyYXRvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQmFzaWNNYXRoSmF4VG9rZW4oL1tcXChcXCldLy50ZXN0KHZhbHVlKT8nYnJhY2tldCc6J29wZXJhdG9yJyxvcGVyYXRvci5uYW1lKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBCYXNpY01hdGhKYXhUb2tlbigndmFyaWFibGUnLHZhbHVlKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgQmFzaWNNYXRoSmF4VG9rZW4oJ251bWJlcicsdmFsdWUpXG4gICAgfVxuICAgIGNsb25lKCk6IEJhc2ljTWF0aEpheFRva2VuIHtyZXR1cm4gbmV3IEJhc2ljTWF0aEpheFRva2VuKHRoaXMudHlwZSB8fCBcIlwiLCB0aGlzLnZhbHVlIGFzIHN0cmluZyB8IG51bWJlcil9XG5cbiAgICBcblxuICAgIGlzVmFsdWVUb2tlbigpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gXCJ2YXJpYWJsZVwiIHx8IHRoaXMudHlwZSA9PT0gXCJudW1iZXJcIjtcbiAgICB9XG5cbiAgICB0b1N0cmluZ0xhdGV4KCk6IHN0cmluZyB7XG4gICAgICAgIGxldCBsYXRleFN0cmluZyA9IFwiXCI7XG4gICAgICAgIGlmICh0aGlzLmlzVmFsdWVTdHJpbmcoKSkge1xuICAgICAgICAgICAgbGF0ZXhTdHJpbmcgKz0gdGhpcy5nZXRMYXRleFN5bWJvbCgpIHx8IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgbGF0ZXhTdHJpbmcgKz0gdGhpcy52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGF0ZXhTdHJpbmc7XG4gICAgfVxuXG4gICAgYWZmZWN0ZWRPcGVyYXRvclJhbmdlKGRpcmVjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLnR5cGUgIT09IFwib3BlcmF0b3JcIiB8fCB0aGlzLnZhbHVlID09PSBcIkVxdWFsc1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdHlwZW9mIHRoaXMudmFsdWUgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gXCJsZWZ0XCIgJiZcbiAgICAgICAgICAgICFpc09wZXJhdG9yV2l0aEFzc29jaWF0aXZpdHkodGhpcy52YWx1ZSwgWy0xLCAxXSwgdHJ1ZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQmFzaWNUaWt6VG9rZW4gZXh0ZW5kcyBCYXNpY1Rva2VuIHtcbiAgICBjb25zdHJ1Y3Rvcih0eXBlPzogc3RyaW5nLCB2YWx1ZT86IHN0cmluZyB8IG51bWJlcikge1xuICAgICAgICBzdXBlcih0eXBlLCB2YWx1ZSk7XG4gICAgfVxuXG4gICAgZ2V0U3RyaW5nVmFsdWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgYXMgc3RyaW5nO1xuICAgIH1cblxuICAgIHNldFZhbHVlKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldE51bWJlclZhbHVlKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlIGFzIG51bWJlcjtcbiAgICB9XG5cbiAgICBzdGF0aWMgY3JlYXRlKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiBCYXNpY1Rpa3pUb2tlbiB7XG4gICAgICAgIGNvbnN0IHRva2VuID0gbmV3IEJhc2ljVGlrelRva2VuKCk7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRva2VuLnR5cGUgPSBcIm51bWJlclwiO1xuICAgICAgICAgICAgdG9rZW4udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpa3pDb21tYW5kID0gc2VhcmNoVGlrekNvbXBvbmVudHModmFsdWUpO1xuICAgICAgICAgICAgaWYgKHRpa3pDb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgdG9rZW4udHlwZSA9IHRpa3pDb21tYW5kLnR5cGUucmVwbGFjZSgvQnJhY2tldC8sIFwiU3ludGF4XCIpO1xuICAgICAgICAgICAgICAgIHRva2VuLnZhbHVlID0gdGlrekNvbW1hbmQubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgfVxuXG4gICAgY2xvbmUoKTogQmFzaWNUaWt6VG9rZW4ge3JldHVybiBuZXcgQmFzaWNUaWt6VG9rZW4odGhpcy50eXBlLCB0aGlzLnZhbHVlKTt9XG5cbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMudmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE51bWJlclZhbHVlKCkudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb21wb25lbnQgPSBzZWFyY2hUaWt6Q29tcG9uZW50cyh0aGlzLnZhbHVlIGFzIHN0cmluZyk7XG4gICAgICAgIGlmIChjb21wb25lbnQgJiYgY29tcG9uZW50LmxhdGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LmxhdGV4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlIGFzIHN0cmluZztcbiAgICB9XG59XG4iXX0=