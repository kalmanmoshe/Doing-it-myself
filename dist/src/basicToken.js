import { isOperatorWithAssociativity, searchAllMathJaxOperatorsAndSymbols, searchMathJaxOperators, searchTikzComponents } from "./staticData/dataManager";
class BasicToken {
    type;
    value;
    constructor(type, value) {
        if (type)
            this.type = type;
        if (value)
            this.value = value;
    }
    getType() { return this.type; }
    getValue() { return this.value; }
    getNumberValue() { return this.value; }
    getStringValue() { return this.value; }
    setValue(value) { this.value = value; }
    isValueString() { return typeof this.value === 'string'; }
}
export class BasicMathJaxToken extends BasicToken {
    constructor(type, value) {
        super(type, value);
    }
    getStringValue() {
        return this.value;
    }
    getLatexSymbol() {
        return typeof this.value === "string"
            ? searchMathJaxOperators(this.value)?.latex
            : undefined;
    }
    getFullType() {
        return this.type;
    }
    static create(value) {
        if (typeof value === "string") {
            const operator = searchAllMathJaxOperatorsAndSymbols(value);
            if (operator) {
                return new BasicMathJaxToken(/[\(\)]/.test(value) ? 'bracket' : 'operator', operator.name);
            }
            return new BasicMathJaxToken('variable', value);
        }
        return new BasicMathJaxToken('number', value);
    }
    clone() { return new BasicMathJaxToken(this.type || "", this.value); }
    isValueToken() {
        return this.type === "variable" || this.type === "number";
    }
    toStringLatex() {
        let latexString = "";
        if (this.isValueString()) {
            latexString += this.getLatexSymbol() || "";
        }
        if (this.type === "number") {
            latexString += this.value;
        }
        return latexString;
    }
    affectedOperatorRange(direction) {
        if (this.type !== "operator" || this.value === "Equals") {
            return false;
        }
        if (typeof this.value === "string" &&
            direction === "left" &&
            !isOperatorWithAssociativity(this.value, [-1, 1], true)) {
            return false;
        }
        return true;
    }
}
export class BasicTikzToken extends BasicToken {
    constructor(type, value) {
        super(type, value);
    }
    getStringValue() {
        return this.value;
    }
    setValue(value) {
        this.value = value;
    }
    getNumberValue() {
        return this.value;
    }
    static create(value) {
        const token = new BasicTikzToken();
        if (typeof value === "number") {
            token.type = "number";
            token.value = value;
        }
        else if (typeof value === "string") {
            const tikzCommand = searchTikzComponents(value);
            if (tikzCommand) {
                token.type = tikzCommand.type.replace(/Bracket/, "Syntax");
                token.value = tikzCommand.name;
            }
        }
        return token;
    }
    clone() { return new BasicTikzToken(this.type, this.value); }
    toString() {
        if (typeof this.value === "number") {
            return this.getNumberValue().toString();
        }
        const component = searchTikzComponents(this.value);
        if (component && component.latex) {
            return component.latex;
        }
        return this.value;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWNUb2tlbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iYXNpY1Rva2VuLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxtQ0FBbUMsRUFBRSxzQkFBc0IsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRTFKLE1BQU0sVUFBVTtJQUNGLElBQUksQ0FBUztJQUNiLEtBQUssQ0FBa0I7SUFFakMsWUFBWSxJQUFhLEVBQUUsS0FBdUI7UUFDOUMsSUFBSSxJQUFJO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDM0IsSUFBSSxLQUFLO1lBQUUsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7SUFDbEMsQ0FBQztJQUNELE9BQU8sS0FBRyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUEsQ0FBQSxDQUFDO0lBQzNCLFFBQVEsS0FBRyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQSxDQUFDO0lBQzdCLGNBQWMsS0FBRyxPQUFPLElBQUksQ0FBQyxLQUFlLENBQUEsQ0FBQSxDQUFDO0lBQzdDLGNBQWMsS0FBRyxPQUFPLElBQUksQ0FBQyxLQUFlLENBQUEsQ0FBQSxDQUFDO0lBQzdDLFFBQVEsQ0FBQyxLQUFvQixJQUFFLElBQUksQ0FBQyxLQUFLLEdBQUMsS0FBSyxDQUFBLENBQUEsQ0FBQztJQUNoRCxhQUFhLEtBQWdDLE9BQU8sT0FBTyxJQUFJLENBQUMsS0FBSyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUM7Q0FDeEY7QUFFRCxNQUFNLE9BQU8saUJBQWtCLFNBQVEsVUFBVTtJQUM3QyxZQUFZLElBQVksRUFBRSxLQUFzQjtRQUM1QyxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7SUFHRCxjQUFjO1FBQ1YsT0FBTyxJQUFJLENBQUMsS0FBZSxDQUFDO0lBQ2hDLENBQUM7SUFFRCxjQUFjO1FBQ1Ys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QUFDO1lBQzVCLEtBQUssQ0FBQyxJQUFJLEdBQUcsUUFBUSxDQUFDO1lBQ3RCLEtBQUssQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1lBQ25DLE1BQU0sV0FBVyxHQUFHLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hELElBQUksV0FBVyxFQUFFLENBQUM7Z0JBQ2QsS0FBSyxDQUFDLElBQUksR0FBRyxXQUFXLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7Z0JBQzNELEtBQUssQ0FBQyxLQUFLLEdBQUcsV0FBVyxDQUFDLElBQUksQ0FBQztZQUNuQyxDQUFDO1FBQ0wsQ0FBQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxLQUFLLEtBQW9CLE9BQU8sSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQSxDQUFDO0lBRTNFLFFBQVE7UUFDSixJQUFJLE9BQU8sSUFBSSxDQUFDLEtBQUssS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUNqQyxPQUFPLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUM1QyxDQUFDO1FBQ0QsTUFBTSxTQUFTLEdBQUcsb0JBQW9CLENBQUMsSUFBSSxDQUFDLEtBQWUsQ0FBQyxDQUFDO1FBQzdELElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUMvQixPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUM7UUFDM0IsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDLEtBQWUsQ0FBQztJQUNoQyxDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc09wZXJhdG9yV2l0aEFzc29jaWF0aXZpdHksIHNlYXJjaEFsbE1hdGhKYXhPcGVyYXRvcnNBbmRTeW1ib2xzLCBzZWFyY2hNYXRoSmF4T3BlcmF0b3JzLCBzZWFyY2hUaWt6Q29tcG9uZW50cyB9IGZyb20gXCIuL3N0YXRpY0RhdGEvZGF0YU1hbmFnZXJcIjtcclxuXHJcbmNsYXNzIEJhc2ljVG9rZW4ge1xyXG4gICAgcHJvdGVjdGVkIHR5cGU6IHN0cmluZztcclxuICAgIHByb3RlY3RlZCB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHR5cGU/OiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nIHwgbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHR5cGUpIHRoaXMudHlwZSA9IHR5cGU7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXRUeXBlKCl7cmV0dXJuIHRoaXMudHlwZX1cclxuICAgIGdldFZhbHVlKCl7cmV0dXJuIHRoaXMudmFsdWV9XHJcbiAgICBnZXROdW1iZXJWYWx1ZSgpe3JldHVybiB0aGlzLnZhbHVlIGFzIG51bWJlcn1cclxuICAgIGdldFN0cmluZ1ZhbHVlKCl7cmV0dXJuIHRoaXMudmFsdWUgYXMgc3RyaW5nfVxyXG4gICAgc2V0VmFsdWUodmFsdWU6IG51bWJlcnxzdHJpbmcpe3RoaXMudmFsdWU9dmFsdWV9XHJcbiAgICBpc1ZhbHVlU3RyaW5nKCk6IHRoaXMgaXMgeyB2YWx1ZTogc3RyaW5nIH0geyByZXR1cm4gdHlwZW9mIHRoaXMudmFsdWUgPT09ICdzdHJpbmcnOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBCYXNpY01hdGhKYXhUb2tlbiBleHRlbmRzIEJhc2ljVG9rZW4ge1xyXG4gICAgY29uc3RydWN0b3IodHlwZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyKSB7XHJcbiAgICAgICAgc3VwZXIodHlwZSwgdmFsdWUpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBnZXRTdHJpbmdWYWx1ZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlIGFzIHN0cmluZztcclxuICAgIH1cclxuXHJcbiAgICBnZXRMYXRleFN5bWJvbCgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgdGhpcy52YWx1ZSA9PT0gXCJzdHJpbmdcIlxyXG4gICAgICAgICAgICA/IHNlYXJjaE1hdGhKYXhPcGVyYXRvcnModGhpcy52YWx1ZSk/LmxhdGV4XHJcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEZ1bGxUeXBlKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjcmVhdGUodmFsdWU6IHN0cmluZ3xudW1iZXIpe1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgY29uc3Qgb3BlcmF0b3IgPSBzZWFyY2hBbGxNYXRoSmF4T3BlcmF0b3JzQW5kU3ltYm9scyh2YWx1ZSlcclxuICAgICAgICAgICAgaWYgKG9wZXJhdG9yKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJhc2ljTWF0aEpheFRva2VuKC9bXFwoXFwpXS8udGVzdCh2YWx1ZSk/J2JyYWNrZXQnOidvcGVyYXRvcicsb3BlcmF0b3IubmFtZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEJhc2ljTWF0aEpheFRva2VuKCd2YXJpYWJsZScsdmFsdWUpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQmFzaWNNYXRoSmF4VG9rZW4oJ251bWJlcicsdmFsdWUpXHJcbiAgICB9XHJcbiAgICBjbG9uZSgpOiBCYXNpY01hdGhKYXhUb2tlbiB7cmV0dXJuIG5ldyBCYXNpY01hdGhKYXhUb2tlbih0aGlzLnR5cGUgfHwgXCJcIiwgdGhpcy52YWx1ZSBhcyBzdHJpbmcgfCBudW1iZXIpfVxyXG5cclxuICAgIFxyXG5cclxuICAgIGlzVmFsdWVUb2tlbigpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50eXBlID09PSBcInZhcmlhYmxlXCIgfHwgdGhpcy50eXBlID09PSBcIm51bWJlclwiO1xyXG4gICAgfVxyXG5cclxuICAgIHRvU3RyaW5nTGF0ZXgoKTogc3RyaW5nIHtcclxuICAgICAgICBsZXQgbGF0ZXhTdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIGlmICh0aGlzLmlzVmFsdWVTdHJpbmcoKSkge1xyXG4gICAgICAgICAgICBsYXRleFN0cmluZyArPSB0aGlzLmdldExhdGV4U3ltYm9sKCkgfHwgXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICBsYXRleFN0cmluZyArPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGF0ZXhTdHJpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgYWZmZWN0ZWRPcGVyYXRvclJhbmdlKGRpcmVjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKHRoaXMudHlwZSAhPT0gXCJvcGVyYXRvclwiIHx8IHRoaXMudmFsdWUgPT09IFwiRXF1YWxzXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHR5cGVvZiB0aGlzLnZhbHVlID09PSBcInN0cmluZ1wiICYmXHJcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gXCJsZWZ0XCIgJiZcclxuICAgICAgICAgICAgIWlzT3BlcmF0b3JXaXRoQXNzb2NpYXRpdml0eSh0aGlzLnZhbHVlLCBbLTEsIDFdLCB0cnVlKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQmFzaWNUaWt6VG9rZW4gZXh0ZW5kcyBCYXNpY1Rva2VuIHtcclxuICAgIGNvbnN0cnVjdG9yKHR5cGU/OiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nIHwgbnVtYmVyKSB7XHJcbiAgICAgICAgc3VwZXIodHlwZSwgdmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFN0cmluZ1ZhbHVlKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgYXMgc3RyaW5nO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFZhbHVlKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TnVtYmVyVmFsdWUoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZSBhcyBudW1iZXI7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNyZWF0ZSh2YWx1ZTogc3RyaW5nIHwgbnVtYmVyKTogQmFzaWNUaWt6VG9rZW4ge1xyXG4gICAgICAgIGNvbnN0IHRva2VuID0gbmV3IEJhc2ljVGlrelRva2VuKCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICB0b2tlbi50eXBlID0gXCJudW1iZXJcIjtcclxuICAgICAgICAgICAgdG9rZW4udmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBjb25zdCB0aWt6Q29tbWFuZCA9IHNlYXJjaFRpa3pDb21wb25lbnRzKHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHRpa3pDb21tYW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0b2tlbi50eXBlID0gdGlrekNvbW1hbmQudHlwZS5yZXBsYWNlKC9CcmFja2V0LywgXCJTeW50YXhcIik7XHJcbiAgICAgICAgICAgICAgICB0b2tlbi52YWx1ZSA9IHRpa3pDb21tYW5kLm5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRva2VuO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb25lKCk6IEJhc2ljVGlrelRva2VuIHtyZXR1cm4gbmV3IEJhc2ljVGlrelRva2VuKHRoaXMudHlwZSwgdGhpcy52YWx1ZSk7fVxyXG5cclxuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnZhbHVlID09PSBcIm51bWJlclwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE51bWJlclZhbHVlKCkudG9TdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gc2VhcmNoVGlrekNvbXBvbmVudHModGhpcy52YWx1ZSBhcyBzdHJpbmcpO1xyXG4gICAgICAgIGlmIChjb21wb25lbnQgJiYgY29tcG9uZW50LmxhdGV4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQubGF0ZXg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlIGFzIHN0cmluZztcclxuICAgIH1cclxufVxyXG4iXX0=