import settings from "../data.json";
export function calculateBinom(n, k, p) {
    return calculateFactorial(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);
}
export function calculateFactorial(n, k) {
    let factoriaN = 1, factoriaK = 1, factoriaNK = 1;
    for (let i = 1; i <= n; i++) {
        factoriaN *= i;
        if (i === k)
            factoriaK = factoriaN;
        if (i === n - k)
            factoriaNK = factoriaN;
    }
    return (factoriaN / (factoriaK * factoriaNK));
}
export function findAngleByCosineRule(side1, side2, oppositeSide) {
    // Law of Cosines: cos(C) = (a^2 + b^2 - c^2) / (2ab)
    const cosAngle = (Math.pow(side1, 2) + Math.pow(side2, 2) - Math.pow(oppositeSide, 2)) / (2 * side1 * side2);
    return radiansToDegrees(Math.acos(cosAngle));
}
export function degreesToRadians(degrees) {
    return degrees * (Math.PI / 180);
}
export function radiansToDegrees(radians) {
    return radians * (180 / Math.PI);
}
export function roundBySettings(input) {
    const number = Number(input);
    return isNaN(number) ? input : Math.round(number * Number(settings.numberFormatting)) / Number(settings.numberFormatting);
}
export function quad(a, b, c, variable) {
    let x1 = (-b + Math.sqrt(Math.pow(b, 2) - 4 * a * c)) / (2 * a);
    let x2 = (-b - Math.sqrt(Math.pow(b, 2) - 4 * a * c)) / (2 * a);
    x1 = roundBySettings(x1);
    x2 = roundBySettings(x2);
    return x1 === x2 ? `${variable} = ${x1}` : `${variable}_1 = ${x1},${variable}_2 = ${x2}`;
}
export function getUsableDegrees(degrees) {
    return ((degrees % 360) + 360) % 360;
}
export const cartesianToPolar = (x, y) => {
    const length = Math.sqrt(x ** 2 + y ** 2); // Calculate the radius
    const angle = getUsableDegrees(radiansToDegrees(Math.atan2(y, x)));
    return { angle: angle, length: length };
};
function tolerance(number) {
    return Math.abs(number) < 1e-10 ? 0 : number;
}
export const polarToCartesian = (angle, length) => {
    const radians = degreesToRadians(getUsableDegrees(angle));
    return { X: tolerance(length * Math.cos(radians)), Y: tolerance(length * Math.sin(radians)) };
};
export function findIntersectionPoint(coordinate1, coordinate2, slope1, slope2) {
    const xValue = ((slope2 * coordinate2.cartesianX) - (slope1 * coordinate1.cartesianX) + (coordinate1.cartesianY - coordinate2.cartesianY)) / (slope2 - slope1);
    return {
        X: xValue,
        Y: createLineFunction(coordinate1, slope1)(xValue)
    };
}
export function toNumber(input) {
    if (typeof input === 'number')
        return input;
    const parsedNumber = Number(input);
    return isNaN(parsedNumber) ? undefined : parsedNumber;
}
function createLineFunction(coordinate, slope) {
    return function (x) {
        return slope * (x - coordinate.cartesianX) + coordinate.cartesianY;
    };
}
export function findSlope(coordinate1, coordinate2) {
    const deltaY = coordinate2.cartesianY - coordinate1.cartesianY;
    const deltaX = coordinate2.cartesianX - coordinate1.cartesianX;
    return deltaY / deltaX;
}
export function calculateCircle(point1, point2, point3) {
    const x1 = point1.cartesianX, y1 = point1.cartesianY;
    const x2 = point2.cartesianX, y2 = point2.cartesianY;
    const x3 = point3.cartesianX, y3 = point3.cartesianY;
    // Calculate the determinants needed for solving the system
    const A = x1 * (y2 - y3) - y1 * (x2 - x3) + (x2 * y3 - y2 * x3);
    const B = (x1 ** 2 + y1 ** 2) * (y3 - y2) + (x2 ** 2 + y2 ** 2) * (y1 - y3) + (x3 ** 2 + y3 ** 2) * (y2 - y1);
    const C = (x1 ** 2 + y1 ** 2) * (x2 - x3) + (x2 ** 2 + y2 ** 2) * (x3 - x1) + (x3 ** 2 + y3 ** 2) * (x1 - x2);
    const D = (x1 ** 2 + y1 ** 2) * (x3 * y2 - x2 * y3) + (x2 ** 2 + y2 ** 2) * (x1 * y3 - x3 * y1) + (x3 ** 2 + y3 ** 2) * (x2 * y1 - x1 * y2);
    if (A === 0) {
        return null; // The points are collinear, no unique circle
    }
    // Calculate the center (h, k) of the circle
    const h = -B / (2 * A);
    const k = -C / (2 * A);
    // Calculate the radius of the circle
    const r = Math.sqrt((B ** 2 + C ** 2 - 4 * A * D) / (4 * A ** 2));
    return {
        center: { X: h, Y: k },
        radius: r,
        equation: `(x - ${h.toFixed(2)})^2 + (y - ${k.toFixed(2)})^2 = ${r.toFixed(2)}^2`
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0aFV0aWxpdGllcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYXRoVXRpbGl0aWVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sUUFBUSxNQUFNLGNBQWMsQ0FBQztBQUdwQyxNQUFNLFVBQVUsY0FBYyxDQUFDLENBQVMsRUFBRSxDQUFTLEVBQUUsQ0FBUztJQUMxRCxPQUFPLGtCQUFrQixDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzdFLENBQUM7QUFFRCxNQUFNLFVBQVUsa0JBQWtCLENBQUMsQ0FBUyxFQUFFLENBQVM7SUFDbkQsSUFBSSxTQUFTLEdBQUcsQ0FBQyxFQUFFLFNBQVMsR0FBRyxDQUFDLEVBQUUsVUFBVSxHQUFHLENBQUMsQ0FBQztJQUNqRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDNUIsU0FBUyxJQUFJLENBQUMsQ0FBQztRQUNmLElBQUksQ0FBQyxLQUFLLENBQUM7WUFBRSxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQ25DLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO1lBQUUsVUFBVSxHQUFHLFNBQVMsQ0FBQztJQUMxQyxDQUFDO0lBQ0QsT0FBTyxDQUFDLFNBQVMsR0FBRyxDQUFDLFNBQVMsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDO0FBQ2xELENBQUM7QUFFRCxNQUFNLFVBQVUscUJBQXFCLENBQUMsS0FBWSxFQUFFLEtBQVksRUFBRSxZQUFtQjtJQUNqRixxREFBcUQ7SUFDckQsTUFBTSxRQUFRLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxD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QUNoRSxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM5RyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM5RyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUU1SSxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUNWLE9BQU8sSUFBSSxDQUFDLENBQUMsNkNBQTZDO0lBQzlELENBQUM7SUFFRCw0Q0FBNEM7SUFDNUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDdkIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFFdkIscUNBQXFDO0lBQ3JDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVsRSxPQUFPO1FBQ0gsTUFBTSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO1FBQ3RCLE1BQU0sRUFBRSxDQUFDO1FBQ1QsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUk7S0FDcEYsQ0FBQztBQUNOLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwIGZyb20gXCJjb25zdGFudHNcIjtcclxuaW1wb3J0IHNldHRpbmdzIGZyb20gXCIuLi9kYXRhLmpzb25cIjtcclxuaW1wb3J0IHsgQXhpcywgQ29vcmRpbmF0ZSB9IGZyb20gXCIuL3Rpa3pqYXgvdGlrempheFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZUJpbm9tKG46IG51bWJlciwgazogbnVtYmVyLCBwOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIGNhbGN1bGF0ZUZhY3RvcmlhbChuLGspICogTWF0aC5wb3cocCwgaykgKiBNYXRoLnBvdygxIC0gcCwgbiAtIGspO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRmFjdG9yaWFsKG46IG51bWJlciwgazogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIGxldCBmYWN0b3JpYU4gPSAxLCBmYWN0b3JpYUsgPSAxLCBmYWN0b3JpYU5LID0gMTtcclxuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IG47IGkrKykge1xyXG4gICAgICBmYWN0b3JpYU4gKj0gaTtcclxuICAgICAgaWYgKGkgPT09IGspIGZhY3RvcmlhSyA9IGZhY3RvcmlhTjtcclxuICAgICAgaWYgKGkgPT09IG4gLSBrKSBmYWN0b3JpYU5LID0gZmFjdG9yaWFOO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIChmYWN0b3JpYU4gLyAoZmFjdG9yaWFLICogZmFjdG9yaWFOSykpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmluZEFuZ2xlQnlDb3NpbmVSdWxlKHNpZGUxOm51bWJlciwgc2lkZTI6bnVtYmVyLCBvcHBvc2l0ZVNpZGU6bnVtYmVyKSB7XHJcbiAgICAvLyBMYXcgb2YgQ29zaW5lczogY29zKEMpID0gKGFeMiArIGJeMiAtIGNeMikgLyAoMmFiKVxyXG4gICAgY29uc3QgY29zQW5nbGUgPSAoTWF0aC5wb3coc2lkZTEsIDIpICsgTWF0aC5wb3coc2lkZTIsIDIpIC0gTWF0aC5wb3cob3Bwb3NpdGVTaWRlLCAyKSkgLyAoMiAqIHNpZGUxICogc2lkZTIpO1xyXG4gICAgcmV0dXJuIHJhZGlhbnNUb0RlZ3JlZXMoTWF0aC5hY29zKGNvc0FuZ2xlKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWdyZWVzVG9SYWRpYW5zKGRlZ3JlZXM6IG51bWJlcil7XHJcbiAgICByZXR1cm4gZGVncmVlcyAqIChNYXRoLlBJIC8gMTgwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJhZGlhbnNUb0RlZ3JlZXMocmFkaWFuczogbnVtYmVyKXtcclxuICAgIHJldHVybiByYWRpYW5zICogKDE4MCAvIE1hdGguUEkgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJvdW5kQnlTZXR0aW5ncyhpbnB1dDogYW55KTogbnVtYmVyICB7XHJcbiAgICBjb25zdCBudW1iZXIgPSBOdW1iZXIoaW5wdXQpO1xyXG4gICAgcmV0dXJuIGlzTmFOKG51bWJlcikgPyBpbnB1dCA6IE1hdGgucm91bmQobnVtYmVyICogTnVtYmVyKHNldHRpbmdzLm51bWJlckZvcm1hdHRpbmcpKSAvIE51bWJlcihzZXR0aW5ncy5udW1iZXJGb3JtYXR0aW5nKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiAgcXVhZChhOiBudW1iZXIsYjogbnVtYmVyLGM6bnVtYmVyLHZhcmlhYmxlOm51bWJlcikge1xyXG4gICAgbGV0IHgxID0gKC1iICsgTWF0aC5zcXJ0KE1hdGgucG93KGIsIDIpIC0gNCAqIGEgKiBjKSkgLyAoMiAqIGEpO1xyXG4gICAgbGV0IHgyID0gKC1iIC0gTWF0aC5zcXJ0KE1hdGgucG93KGIsIDIpIC0gNCAqIGEgKiBjKSkgLyAoMiAqIGEpO1xyXG4gICAgeDE9cm91bmRCeVNldHRpbmdzKHgxKTtcclxuICAgIHgyPXJvdW5kQnlTZXR0aW5ncyh4Mik7XHJcbiAgICByZXR1cm4geDE9PT14Mj9gJHt2YXJpYWJsZX0gPSAke3gxfWA6YCR7dmFyaWFibGV9XzEgPSAke3gxfSwke3ZhcmlhYmxlfV8yID0gJHt4Mn1gO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFVzYWJsZURlZ3JlZXMoZGVncmVlczogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIHJldHVybiAoKGRlZ3JlZXMgJSAzNjApICsgMzYwKSAlIDM2MDtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNhcnRlc2lhblRvUG9sYXIgPSAoeDogbnVtYmVyLCB5OiBudW1iZXIpID0+IHtcclxuICAgIGNvbnN0IGxlbmd0aCA9IE1hdGguc3FydCh4ICoqIDIgKyB5ICoqIDIpOyAvLyBDYWxjdWxhdGUgdGhlIHJhZGl1c1xyXG4gICAgY29uc3QgYW5nbGUgPSBnZXRVc2FibGVEZWdyZWVzKHJhZGlhbnNUb0RlZ3JlZXMoTWF0aC5hdGFuMih5LCB4KSkpOyBcclxuICAgIHJldHVybiB7IGFuZ2xlOiBhbmdsZSwgbGVuZ3RoOiBsZW5ndGggfTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIHRvbGVyYW5jZShudW1iZXI6IG51bWJlcikge1xyXG4gICAgcmV0dXJuIE1hdGguYWJzKG51bWJlcikgPCAxZS0xMCA/IDAgOiBudW1iZXI7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY29uc3QgcG9sYXJUb0NhcnRlc2lhbiA9IChhbmdsZTogbnVtYmVyLCBsZW5ndGg6IG51bWJlcikgPT4ge1xyXG4gICAgY29uc3QgcmFkaWFucyA9IGRlZ3JlZXNUb1JhZGlhbnMoZ2V0VXNhYmxlRGVncmVlcyhhbmdsZSkpO1xyXG4gICAgcmV0dXJuIHsgWDogdG9sZXJhbmNlKGxlbmd0aCAqIE1hdGguY29zKHJhZGlhbnMpKSwgWTogdG9sZXJhbmNlKGxlbmd0aCAqIE1hdGguc2luKHJhZGlhbnMpKSB9O1xyXG59O1xyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaW5kSW50ZXJzZWN0aW9uUG9pbnQoY29vcmRpbmF0ZTE6IEF4aXMsIGNvb3JkaW5hdGUyOiBBeGlzLCBzbG9wZTE6IG51bWJlciwgc2xvcGUyOiBudW1iZXIpIHtcclxuICAgIGNvbnN0IHhWYWx1ZSA9ICgoc2xvcGUyICogY29vcmRpbmF0ZTIuY2FydGVzaWFuWCkgLSAoc2xvcGUxICogY29vcmRpbmF0ZTEuY2FydGVzaWFuWCkgKyAoY29vcmRpbmF0ZTEuY2FydGVzaWFuWSAtIGNvb3JkaW5hdGUyLmNhcnRlc2lhblkpKSAvIChzbG9wZTIgLSBzbG9wZTEpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBYOiB4VmFsdWUsIFxyXG4gICAgICAgIFk6IGNyZWF0ZUxpbmVGdW5jdGlvbihjb29yZGluYXRlMSwgc2xvcGUxKSh4VmFsdWUpXHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdG9OdW1iZXIoaW5wdXQ6IHN0cmluZyB8IG51bWJlcik6IG51bWJlcnx1bmRlZmluZWQge1xyXG4gICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ251bWJlcicpIHJldHVybiBpbnB1dDtcclxuICAgIGNvbnN0IHBhcnNlZE51bWJlciA9IE51bWJlcihpbnB1dCk7XHJcbiAgICByZXR1cm4gaXNOYU4ocGFyc2VkTnVtYmVyKSA/IHVuZGVmaW5lZCA6IHBhcnNlZE51bWJlcjtcclxufVxyXG4gIFxyXG5cclxuZnVuY3Rpb24gY3JlYXRlTGluZUZ1bmN0aW9uKGNvb3JkaW5hdGU6IEF4aXMsIHNsb3BlOiBudW1iZXIpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbih4OiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gc2xvcGUgKiAoeCAtIGNvb3JkaW5hdGUuY2FydGVzaWFuWCkgKyBjb29yZGluYXRlLmNhcnRlc2lhblk7XHJcbiAgICB9O1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRTbG9wZShjb29yZGluYXRlMTogQXhpcywgY29vcmRpbmF0ZTI6IEF4aXMpIHtcclxuICAgIGNvbnN0IGRlbHRhWSA9IGNvb3JkaW5hdGUyLmNhcnRlc2lhblkgLSBjb29yZGluYXRlMS5jYXJ0ZXNpYW5ZO1xyXG4gICAgY29uc3QgZGVsdGFYID0gY29vcmRpbmF0ZTIuY2FydGVzaWFuWCAtIGNvb3JkaW5hdGUxLmNhcnRlc2lhblg7XHJcbiAgICByZXR1cm4gZGVsdGFZIC8gZGVsdGFYO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZUNpcmNsZShwb2ludDE6IEF4aXMsIHBvaW50MjogQXhpcywgcG9pbnQzOiBBeGlzKSB7XHJcbiAgICBjb25zdCB4MSA9IHBvaW50MS5jYXJ0ZXNpYW5YLCB5MSA9IHBvaW50MS5jYXJ0ZXNpYW5ZO1xyXG4gICAgY29uc3QgeDIgPSBwb2ludDIuY2FydGVzaWFuWCwgeTIgPSBwb2ludDIuY2FydGVzaWFuWTtcclxuICAgIGNvbnN0IHgzID0gcG9pbnQzLmNhcnRlc2lhblgsIHkzID0gcG9pbnQzLmNhcnRlc2lhblk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHRoZSBkZXRlcm1pbmFudHMgbmVlZGVkIGZvciBzb2x2aW5nIHRoZSBzeXN0ZW1cclxuICAgIGNvbnN0IEEgPSB4MSAqICh5MiAtIHkzKSAtIHkxICogKHgyIC0geDMpICsgKHgyICogeTMgLSB5MiAqIHgzKTtcclxuICAgIGNvbnN0IEIgPSAoeDEgKiogMiArIHkxICoqIDIpICogKHkzIC0geTIpICsgKHgyICoqIDIgKyB5MiAqKiAyKSAqICh5MSAtIHkzKSArICh4MyAqKiAyICsgeTMgKiogMikgKiAoeTIgLSB5MSk7XHJcbiAgICBjb25zdCBDID0gKHgxICoqIDIgKyB5MSAqKiAyKSAqICh4MiAtIHgzKSArICh4MiAqKiAyICsgeTIgKiogMikgKiAoeDMgLSB4MSkgKyAoeDMgKiogMiArIHkzICoqIDIpICogKHgxIC0geDIpO1xyXG4gICAgY29uc3QgRCA9ICh4MSAqKiAyICsgeTEgKiogMikgKiAoeDMgKiB5MiAtIHgyICogeTMpICsgKHgyICoqIDIgKyB5MiAqKiAyKSAqICh4MSAqIHkzIC0geDMgKiB5MSkgKyAoeDMgKiogMiArIHkzICoqIDIpICogKHgyICogeTEgLSB4MSAqIHkyKTtcclxuXHJcbiAgICBpZiAoQSA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBudWxsOyAvLyBUaGUgcG9pbnRzIGFyZSBjb2xsaW5lYXIsIG5vIHVuaXF1ZSBjaXJjbGVcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGhlIGNlbnRlciAoaCwgaykgb2YgdGhlIGNpcmNsZVxyXG4gICAgY29uc3QgaCA9IC1CIC8gKDIgKiBBKTtcclxuICAgIGNvbnN0IGsgPSAtQyAvICgyICogQSk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHRoZSByYWRpdXMgb2YgdGhlIGNpcmNsZVxyXG4gICAgY29uc3QgciA9IE1hdGguc3FydCgoQiAqKiAyICsgQyAqKiAyIC0gNCAqIEEgKiBEKSAvICg0ICogQSAqKiAyKSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjZW50ZXI6IHsgWDogaCwgWTogayB9LFxyXG4gICAgICAgIHJhZGl1czogcixcclxuICAgICAgICBlcXVhdGlvbjogYCh4IC0gJHtoLnRvRml4ZWQoMil9KV4yICsgKHkgLSAke2sudG9GaXhlZCgyKX0pXjIgPSAke3IudG9GaXhlZCgyKX1eMmBcclxuICAgIH07XHJcbn0iXX0=