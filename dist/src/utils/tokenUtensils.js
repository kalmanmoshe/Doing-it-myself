export class Paren {
    type;
    depth;
    depthID;
    constructor(depth, depthID, type) {
        this.depth = depth;
        this.depthID = depthID;
        this.type = type;
    }
    toString() { this.id = this.depth + "." + this.depthID; }
    compare(Paren) { return this.depth === Paren.depth && this.depthID === Paren.depthID; }
    addDepth(num) { this.depth += num; }
    adddepthID(num) { this.depthID += num; }
}
const open = ['Parentheses_open', 'Curly_brackets_open', 'Square_brackets_open'];
const close = ['Parentheses_close', 'Curly_brackets_close', 'Square_brackets_close'];
export function idParentheses(tokens) {
    let depth = 0;
    const depthCounts = {};
    for (let i = 0; i < tokens.length; i++) {
        const token = tokens[i];
        if (open.includes(token.name)) {
            if (!depthCounts[depth]) {
                depthCounts[depth] = 0;
            }
            const depthID = depthCounts[depth]++;
            token.value = new Paren(depth, depthID, token.value);
            // Increase depth for nested parentheses
            depth++;
            continue;
        }
        if (close.includes(token.name)) {
            // Decrease depth and check for unmatched closing parenthesis
            depth--;
            if (depth < 0) {
                console.error(token.value, tokens);
                throw new Error("Unmatched closing parenthesis detected.");
            }
            // Assign a unique ID to the closing parenthesis
            const depthID = depthCounts[depth] - 1;
            token.value = new Paren(depth, depthID, token.value);
        }
    }
    // Check for unmatched opening parentheses
    if (depth !== 0) {
        console.error(tokens);
        throw new Error(`Unmatched opening parenthesis(es) detected: depth=${depth}`);
    }
}
export function mapBrackets(type, tokens) {
    return tokens
        .map((token, index) => token.name === type
        ? findParenIndex(token.value, undefined, tokens)
        : null)
        .filter((t) => t !== null);
}
export function findModifiedParenIndex(id, index, tokens, depth, depthID, filter) {
    // Initialize `id` as a new instance if not already provided
    id = id
        ? new Paren(id.depth, id.depthID)
        : new Paren(tokens[index].value.depth, tokens[index].value.depthID);
    if (depth !== undefined && depthID !== undefined) {
        id.depth += depth || 0;
        id.depthID += depthID || 0;
    }
    const openIndex = tokens.findIndex(token => {
        if (open.includes(token.name) && token.value?.compare(id)) {
            if (filter && !token.name.startsWith(filter)) {
                id.depth = token.value.depth + (depth || 0);
                id.depthID = token.value.depthID + (depthID || 0);
                return false;
            }
            return true;
        }
        return false;
    });
    const closeIndex = tokens.findLastIndex(token => close.includes(token.name) &&
        token.value?.compare(id));
    return { open: openIndex, close: closeIndex, id };
}
export function findParenIndex(id, index, tokens) {
    id = id ? id : tokens[index].value;
    const openIndex = tokens.findIndex(token => open.includes(token.name)
        && token.value?.compare(id));
    const closeIndex = tokens.findLastIndex(token => close.includes(token.name)
        && token.value?.compare(id));
    return { open: openIndex, close: closeIndex, id: id };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9rZW5VdGVuc2lscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy90b2tlblV0ZW5zaWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sT0FBTyxLQUFLO0lBQ2QsSUFBSSxDQUFDO0lBQ0wsS0FBSyxDQUFDO0lBQ04sT0FBTyxDQUFDO0lBRVIsWUFBWSxLQUFLLEVBQUMsT0FBTyxFQUFDLElBQUk7UUFDMUIsSUFBSSxDQUFDLEtBQUssR0FBQyxLQUFLLENBQUM7UUFDakIsSUFBSSxDQUFDLE9BQU8sR0FBQyxPQUFPLENBQUM7UUFDckIsSUFBSSxDQUFDLElBQUksR0FBQyxJQUFJLENBQUE7SUFDbEIsQ0FBQztJQUNELFFBQVEsS0FBRyxJQUFJLENBQUMsRUFBRSxHQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUEsQ0FBQSxDQUFDO0lBQ25ELE9BQU8sQ0FBQyxLQUFLLElBQUUsT0FBTyxJQUFJLENBQUMsS0FBSyxLQUFHLEtBQUssQ0FBQyxLQUFLLElBQUUsSUFBSSxDQUFDLE9BQU8sS0FBRyxLQUFLLENBQUMsT0FBTyxDQUFBLENBQUEsQ0FBQztJQUM3RSxRQUFRLENBQUMsR0FBRyxJQUFFLElBQUksQ0FBQyxLQUFLLElBQUUsR0FBRyxDQUFBLENBQUEsQ0FBQztJQUM5QixVQUFVLENBQUMsR0FBRyxJQUFFLElBQUksQ0FBQyxPQUFPLElBQUUsR0FBRyxDQUFBLENBQUEsQ0FBQztDQUNyQztBQUNELE1BQU0sSUFBSSxHQUFDLENBQUMsa0JBQWtCLEVBQUMscUJBQXFCLEVBQUMsc0JBQXNCLENBQUMsQ0FBQztBQUM3RSxNQUFNLEtBQUssR0FBQyxDQUFDLG1CQUFtQixFQUFDLHNCQUFzQixFQUFDLHVCQUF1QixDQUFDLENBQUM7QUFFakYsTUFBTSxVQUFVLGFBQWEsQ0FBQyxNQUFNO0lBQ2hDLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztJQUNk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LEVBQUUsQ0FBQSxDQUFDLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQztJQUU3QixNQUFNLFNBQVMsR0FBQyxNQUFNLENBQUMsU0FBUyxDQUM1QixLQUFLLENBQUEsRUFBRSxDQUFBLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztXQUM5QixLQUFLLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FDN0IsQ0FBQTtJQUNELE1BQU0sVUFBVSxHQUFDLE1BQU0sQ0FBQyxhQUFhLENBQ2pDLEtBQUssQ0FBQSxFQUFFLENBQUEsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO1dBQy9CLEtBQUssQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUM3QixDQUFBO0lBQ0QsT0FBTSxFQUFDLElBQUksRUFBRSxTQUFTLEVBQUMsS0FBSyxFQUFFLFVBQVUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLENBQUE7QUFDbkQsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBQYXJlbntcclxuICAgIHR5cGU7XHJcbiAgICBkZXB0aDtcclxuICAgIGRlcHRoSUQ7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKGRlcHRoLGRlcHRoSUQsdHlwZSl7XHJcbiAgICAgICAgdGhpcy5kZXB0aD1kZXB0aDtcclxuICAgICAgICB0aGlzLmRlcHRoSUQ9ZGVwdGhJRDtcclxuICAgICAgICB0aGlzLnR5cGU9dHlwZVxyXG4gICAgfVxyXG4gICAgdG9TdHJpbmcoKXt0aGlzLmlkPXRoaXMuZGVwdGggKyBcIi5cIiArIHRoaXMuZGVwdGhJRH1cclxuICAgIGNvbXBhcmUoUGFyZW4pe3JldHVybiB0aGlzLmRlcHRoPT09UGFyZW4uZGVwdGgmJnRoaXMuZGVwdGhJRD09PVBhcmVuLmRlcHRoSUR9XHJcbiAgICBhZGREZXB0aChudW0pe3RoaXMuZGVwdGgrPW51bX1cclxuICAgIGFkZGRlcHRoSUQobnVtKXt0aGlzLmRlcHRoSUQrPW51bX1cclxufVxyXG5jb25zdCBvcGVuPVsnUGFyZW50aGVzZXNfb3BlbicsJ0N1cmx5X2JyYWNrZXRzX29wZW4nLCdTcXVhcmVfYnJhY2tldHNfb3BlbiddO1xyXG5jb25zdCBjbG9zZT1bJ1BhcmVudGhlc2VzX2Nsb3NlJywnQ3VybHlfYnJhY2tldHNfY2xvc2UnLCdTcXVhcmVfYnJhY2tldHNfY2xvc2UnXTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpZFBhcmVudGhlc2VzKHRva2Vucykge1xyXG4gICAgbGV0IGRlcHRoID0gMDtcclxuICAgIGNvbnN0IGRlcHRoQ291bnRzID0ge307XHJcbiAgICBcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgdG9rZW4gPSB0b2tlbnNbaV07XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKG9wZW4uaW5jbHVkZXModG9rZW4ubmFtZSkpIHtcclxuICAgICAgICAgICAgaWYgKCFkZXB0aENvdW50c1tkZXB0aF0pIHtcclxuICAgICAgICAgICAgICAgIGRlcHRoQ291bnRzW2RlcHRoXSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlcHRoSUQgPSBkZXB0aENvdW50c1tkZXB0aF0rKztcclxuICAgICAgICAgICAgdG9rZW4udmFsdWUgPSBuZXcgUGFyZW4oZGVwdGgsIGRlcHRoSUQsdG9rZW4udmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgLy8gSW5jcmVhc2UgZGVwdGggZm9yIG5lc3RlZCBwYXJlbnRoZXNlc1xyXG4gICAgICAgICAgICBkZXB0aCsrO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjbG9zZS5pbmNsdWRlcyh0b2tlbi5uYW1lKSkge1xyXG4gICAgICAgICAgICAvLyBEZWNyZWFzZSBkZXB0aCBhbmQgY2hlY2sgZm9yIHVubWF0Y2hlZCBjbG9zaW5nIHBhcmVudGhlc2lzXHJcbiAgICAgICAgICAgIGRlcHRoLS07XHJcbiAgICAgICAgICAgIGlmIChkZXB0aCA8IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IodG9rZW4udmFsdWUsdG9rZW5zKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5tYXRjaGVkIGNsb3NpbmcgcGFyZW50aGVzaXMgZGV0ZWN0ZWQuXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBc3NpZ24gYSB1bmlxdWUgSUQgdG8gdGhlIGNsb3NpbmcgcGFyZW50aGVzaXNcclxuICAgICAgICAgICAgY29uc3QgZGVwdGhJRCA9IGRlcHRoQ291bnRzW2RlcHRoXSAtIDE7XHJcbiAgICAgICAgICAgIHRva2VuLnZhbHVlID0gbmV3IFBhcmVuKGRlcHRoLCBkZXB0aElELHRva2VuLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIHVubWF0Y2hlZCBvcGVuaW5nIHBhcmVudGhlc2VzXHJcbiAgICBpZiAoZGVwdGggIT09IDApIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKHRva2VucylcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVubWF0Y2hlZCBvcGVuaW5nIHBhcmVudGhlc2lzKGVzKSBkZXRlY3RlZDogZGVwdGg9JHtkZXB0aH1gKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1hcEJyYWNrZXRzKHR5cGUsdG9rZW5zKXtcclxuICAgIHJldHVybiB0b2tlbnNcclxuICAgICAgICAubWFwKCh0b2tlbiwgaW5kZXgpID0+IFxyXG4gICAgICAgICAgICB0b2tlbi5uYW1lID09PSB0eXBlXHJcbiAgICAgICAgICAgICAgICA/IGZpbmRQYXJlbkluZGV4KHRva2VuLnZhbHVlLCB1bmRlZmluZWQsIHRva2VucykgXHJcbiAgICAgICAgICAgICAgICA6IG51bGxcclxuICAgICAgICApXHJcbiAgICAgICAgLmZpbHRlcigodCkgPT4gdCAhPT0gbnVsbCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaW5kTW9kaWZpZWRQYXJlbkluZGV4KGlkLCBpbmRleCwgdG9rZW5zLCBkZXB0aCwgZGVwdGhJRCwgZmlsdGVyKSB7XHJcbiAgICAvLyBJbml0aWFsaXplIGBpZGAgYXMgYSBuZXcgaW5zdGFuY2UgaWYgbm90IGFscmVhZHkgcHJvdmlkZWRcclxuICAgIGlkID0gaWRcclxuICAgICAgICA/IG5ldyBQYXJlbihpZC5kZXB0aCwgaWQuZGVwdGhJRClcclxuICAgICAgICA6IG5ldyBQYXJlbih0b2tlbnNbaW5kZXhdLnZhbHVlLmRlcHRoLCB0b2tlbnNbaW5kZXhdLnZhbHVlLmRlcHRoSUQpO1xyXG5cclxuICAgIGlmIChkZXB0aCAhPT0gdW5kZWZpbmVkICYmIGRlcHRoSUQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGlkLmRlcHRoICs9IGRlcHRoIHx8IDA7XHJcbiAgICAgICAgaWQuZGVwdGhJRCArPSBkZXB0aElEIHx8IDA7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgb3BlbkluZGV4ID0gdG9rZW5zLmZpbmRJbmRleCh0b2tlbiA9PiB7XHJcbiAgICAgICAgaWYgKG9wZW4uaW5jbHVkZXModG9rZW4ubmFtZSkgJiYgdG9rZW4udmFsdWU/LmNvbXBhcmUoaWQpKSB7XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXIgJiYgIXRva2VuLm5hbWUuc3RhcnRzV2l0aChmaWx0ZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBpZC5kZXB0aCA9IHRva2VuLnZhbHVlLmRlcHRoICsgKGRlcHRoIHx8IDApXHJcbiAgICAgICAgICAgICAgICBpZC5kZXB0aElEPXRva2VuLnZhbHVlLmRlcHRoSUQgKyAoZGVwdGhJRCB8fCAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbG9zZUluZGV4ID0gdG9rZW5zLmZpbmRMYXN0SW5kZXgoXHJcbiAgICAgICAgdG9rZW4gPT5cclxuICAgICAgICAgICAgY2xvc2UuaW5jbHVkZXModG9rZW4ubmFtZSkgJiZcclxuICAgICAgICAgICAgdG9rZW4udmFsdWU/LmNvbXBhcmUoaWQpXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiB7IG9wZW46IG9wZW5JbmRleCwgY2xvc2U6IGNsb3NlSW5kZXgsIGlkIH07XHJcbn1cclxuXHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRQYXJlbkluZGV4KGlkLGluZGV4LHRva2Vucyl7XHJcbiAgICBpZD1pZD9pZDp0b2tlbnNbaW5kZXhdLnZhbHVlO1xyXG5cclxuICAgIGNvbnN0IG9wZW5JbmRleD10b2tlbnMuZmluZEluZGV4KFxyXG4gICAgICAgIHRva2VuPT5vcGVuLmluY2x1ZGVzKHRva2VuLm5hbWUpXHJcbiAgICAgICAgJiZ0b2tlbi52YWx1ZT8uY29tcGFyZShpZClcclxuICAgIClcclxuICAgIGNvbnN0IGNsb3NlSW5kZXg9dG9rZW5zLmZpbmRMYXN0SW5kZXgoXHJcbiAgICAgICAgdG9rZW49PmNsb3NlLmluY2x1ZGVzKHRva2VuLm5hbWUpXHJcbiAgICAgICAgJiZ0b2tlbi52YWx1ZT8uY29tcGFyZShpZClcclxuICAgIClcclxuICAgIHJldHVybntvcGVuOiBvcGVuSW5kZXgsY2xvc2U6IGNsb3NlSW5kZXgsaWQ6aWR9XHJcbn0iXX0=