import { Platform } from "obsidian";
import { EditorView } from "@codemirror/view";
export function replaceRange(view, start, end, replacement) {
    view.dispatch({
        changes: { from: start, to: end, insert: replacement }
    });
}
export function getCharacterAtPos(viewOrState, pos) {
    const state = viewOrState instanceof EditorView ? viewOrState.state : viewOrState;
    const doc = state.doc;
    return doc.slice(pos, pos + 1).toString();
}
export function setCursor(view, pos) {
    view.dispatch({
        selection: { anchor: pos, head: pos }
    });
    resetCursorBlink();
}
export function setSelection(view, start, end) {
    view.dispatch({
        selection: { anchor: start, head: end }
    });
    resetCursorBlink();
}
export function resetCursorBlink() {
    if (Platform.isMobile)
        return;
    const cursorLayer = document.getElementsByClassName("cm-cursorLayer")[0];
    if (cursorLayer) {
        const curAnim = cursorLayer.style.animationName;
        cursorLayer.style.animationName = curAnim === "cm-blink" ? "cm-blink2" : "cm-blink";
    }
}
export function reverse(s) {
    return s.split("").reverse().join("");
}
export function findMatchingBracket(text, start, openBracket, closeBracket, searchBackwards, end) {
    if (searchBackwards) {
        const reversedIndex = findMatchingBracket(reverse(text), text.length - (start + closeBracket.length), reverse(closeBracket), reverse(openBracket), false);
        if (reversedIndex === -1)
            return -1;
        return text.length - (reversedIndex + openBracket.length);
    }
    let brackets = 0;
    const stop = end ? end : text.length;
    for (let i = start; i < stop; i++) {
        if (text.slice(i, i + openBracket.length) === openBracket) {
            brackets++;
        }
        else if (text.slice(i, i + closeBracket.length) === closeBracket) {
            brackets--;
            if (brackets === 0) {
                return i;
            }
        }
    }
    return -1;
}
export function getOpenBracket(closeBracket) {
    const openBrackets = { ")": "(", "]": "[", "}": "{" };
    return openBrackets[closeBracket];
}
export function getCloseBracket(openBracket) {
    const closeBrackets = { "(": ")", "[": "]", "{": "}" };
    return closeBrackets[openBracket];
}
export var Direction;
(function (Direction) {
    Direction[Direction["Backward"] = 0] = "Backward";
    Direction[Direction["Forward"] = 1] = "Forward";
})(Direction || (Direction = {}));
/**
  * Searches for a token in siblings and parents, in only one direction.
  *
  * @param cursor: Where to start iteration
  * @param dir: In which direction to look for the target node
  * @param target: What substring the target node should have
  *
  * @returns The node found or null if none was found.
  */
export function escalateToToken(cursor, dir, target) {
    // Allow the starting node to be a match
    if (cursor.name.contains(target)) {
        return cursor.node;
    }
    while ((cursor.name != "Document") &&
        ((dir == Direction.Backward && cursor.prev())
            || (dir == Direction.Forward && cursor.next())
            || cursor.parent())) {
        if (cursor.name.contains(target)) {
            return cursor.node;
        }
    }
    return null;
}
/**
 * Check if the user is typing in an IME composition.
 * Returns true even if the given event is the first keydown event of an IME composition.
 */
export function isComposing(view, event) {
    // view.composing and event.isComposing are false for the first keydown event of an IME composition,
    // so we need to check for event.keyCode === 229 to prevent IME from triggering keydown events.
    // Note that keyCode is deprecated - it is used here because it is apparently the only way to detect the first keydown event of an IME composition.
    return view.composing || event.keyCode === 229;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdG9yX3V0aWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3V0aWxzL2VkaXRvcl91dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ3BDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUk5QyxNQUFNLFVBQVUsWUFBWSxDQUFDLElBQWdCLEVBQUUsS0FBYSxFQUFFLEdBQVcsRUFBRSxXQUFtQjtJQUM3RixJQUFJLENBQUMsUUFBUSxDQUFDO1FBQ2IsT0FBTyxFQUFFLEVBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUM7S0FDcEQsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU0sVUFBVSxpQkFBaUIsQ0FBQyxXQUFxQyxFQUFFLEdBQVc7SUFDbkYsTUFBTSxLQUFLLEdBQUcsV0FBVyxZQUFZLFVBQVUsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDO0lBQ2xGLE1BQU0sR0FBRyxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUM7SUFDdEIsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLEdBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDekMsQ0FBQztBQUdELE1BQU0sVUFBVSxTQUFTLENBQUMsSUFBZ0IsRUFBRSxHQUFXO0lBQ3RELElBQUksQ0FBQyxRQUFRLENBQUM7UUFDYixTQUFTLEVBQUUsRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUM7S0FDbkMsQ0FBQyxDQUFDO0lBRUgsZ0JBQWdCLEVBQUUsQ0FBQztBQUNwQixDQUFDO0FBR0QsTUFBTSxVQUFVLFlBQVksQ0FBQyxJQUFnQixFQUFFLEtBQWEsRUFBRSxHQUFXO0lB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S0FBSyxHQUFHLENBQUM7QUFDaEQsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xyXG5pbXBvcnQgeyBTeW50YXhOb2RlLCBUcmVlQ3Vyc29yIH0gZnJvbSBcIkBsZXplci9jb21tb25cIjtcclxuaW1wb3J0IHsgRWRpdG9yU3RhdGUgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivc3RhdGVcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlUmFuZ2UodmlldzogRWRpdG9yVmlldywgc3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXIsIHJlcGxhY2VtZW50OiBzdHJpbmcpIHtcclxuXHR2aWV3LmRpc3BhdGNoKHtcclxuXHRcdGNoYW5nZXM6IHtmcm9tOiBzdGFydCwgdG86IGVuZCwgaW5zZXJ0OiByZXBsYWNlbWVudH1cclxuXHR9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYXJhY3RlckF0UG9zKHZpZXdPclN0YXRlOiBFZGl0b3JWaWV3IHwgRWRpdG9yU3RhdGUsIHBvczogbnVtYmVyKSB7XHJcblx0Y29uc3Qgc3RhdGUgPSB2aWV3T3JTdGF0ZSBpbnN0YW5jZW9mIEVkaXRvclZpZXcgPyB2aWV3T3JTdGF0ZS5zdGF0ZSA6IHZpZXdPclN0YXRlO1xyXG5cdGNvbnN0IGRvYyA9IHN0YXRlLmRvYztcclxuXHRyZXR1cm4gZG9jLnNsaWNlKHBvcywgcG9zKzEpLnRvU3RyaW5nKCk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3Vyc29yKHZpZXc6IEVkaXRvclZpZXcsIHBvczogbnVtYmVyKSB7XHJcblx0dmlldy5kaXNwYXRjaCh7XHJcblx0XHRzZWxlY3Rpb246IHthbmNob3I6IHBvcywgaGVhZDogcG9zfVxyXG5cdH0pO1xyXG5cclxuXHRyZXNldEN1cnNvckJsaW5rKCk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0U2VsZWN0aW9uKHZpZXc6IEVkaXRvclZpZXcsIHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKSB7XHJcblx0dmlldy5kaXNwYXRjaCh7XHJcblx0XHRzZWxlY3Rpb246IHthbmNob3I6IHN0YXJ0LCBoZWFkOiBlbmR9XHJcblx0fSk7XHJcblxyXG5cdHJlc2V0Q3Vyc29yQmxpbmsoKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZXNldEN1cnNvckJsaW5rKCkge1xyXG5cdGlmIChQbGF0Zm9ybS5pc01vYmlsZSkgcmV0dXJuO1xyXG5cclxuXHRjb25zdCBjdXJzb3JMYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjbS1jdXJzb3JMYXllclwiKVswXSBhcyBIVE1MRWxlbWVudDtcclxuXHJcblx0aWYgKGN1cnNvckxheWVyKSB7XHJcblx0XHRjb25zdCBjdXJBbmltID0gY3Vyc29yTGF5ZXIuc3R5bGUuYW5pbWF0aW9uTmFtZTtcclxuXHRcdGN1cnNvckxheWVyLnN0eWxlLmFuaW1hdGlvbk5hbWUgPSBjdXJBbmltID09PSBcImNtLWJsaW5rXCIgPyBcImNtLWJsaW5rMlwiIDogXCJjbS1ibGlua1wiO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZXZlcnNlKHM6IHN0cmluZyl7XHJcblx0cmV0dXJuIHMuc3BsaXQoXCJcIikucmV2ZXJzZSgpLmpvaW4oXCJcIik7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmluZE1hdGNoaW5nQnJhY2tldCh0ZXh0OiBzdHJpbmcsIHN0YXJ0OiBudW1iZXIsIG9wZW5CcmFja2V0OiBzdHJpbmcsIGNsb3NlQnJhY2tldDogc3RyaW5nLCBzZWFyY2hCYWNrd2FyZHM6IGJvb2xlYW4sIGVuZD86IG51bWJlcik6bnVtYmVyIHtcclxuXHRpZiAoc2VhcmNoQmFja3dhcmRzKSB7XHJcblx0XHRjb25zdCByZXZlcnNlZEluZGV4ID0gZmluZE1hdGNoaW5nQnJhY2tldChyZXZlcnNlKHRleHQpLCB0ZXh0Lmxlbmd0aCAtIChzdGFydCArIGNsb3NlQnJhY2tldC5sZW5ndGgpLCByZXZlcnNlKGNsb3NlQnJhY2tldCksIHJldmVyc2Uob3BlbkJyYWNrZXQpLCBmYWxzZSk7XHJcblxyXG5cdFx0aWYgKHJldmVyc2VkSW5kZXggPT09IC0xKSByZXR1cm4gLTE7XHJcblxyXG5cdFx0cmV0dXJuIHRleHQubGVuZ3RoIC0gKHJldmVyc2VkSW5kZXggKyBvcGVuQnJhY2tldC5sZW5ndGgpXHJcblx0fVxyXG5cclxuXHRsZXQgYnJhY2tldHMgPSAwO1xyXG5cdGNvbnN0IHN0b3AgPSBlbmQgPyBlbmQgOiB0ZXh0Lmxlbmd0aDtcclxuXHJcblx0Zm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgc3RvcDsgaSsrKSB7XHJcblx0XHRpZiAodGV4dC5zbGljZShpLCBpICsgb3BlbkJyYWNrZXQubGVuZ3RoKSA9PT0gb3BlbkJyYWNrZXQpIHtcclxuXHRcdFx0YnJhY2tldHMrKztcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKHRleHQuc2xpY2UoaSwgaSArIGNsb3NlQnJhY2tldC5sZW5ndGgpID09PSBjbG9zZUJyYWNrZXQpIHtcclxuXHRcdFx0YnJhY2tldHMtLTtcclxuXHJcblx0XHRcdGlmIChicmFja2V0cyA9PT0gMCkge1xyXG5cdFx0XHRcdHJldHVybiBpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gLTE7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3BlbkJyYWNrZXQoY2xvc2VCcmFja2V0OiBzdHJpbmcpIHtcclxuXHRjb25zdCBvcGVuQnJhY2tldHM6e1tjbG9zZUJyYWNrZXQ6IHN0cmluZ106IHN0cmluZ30gPSB7XCIpXCI6IFwiKFwiLCBcIl1cIjogXCJbXCIsIFwifVwiOiBcIntcIn07XHJcblxyXG5cdHJldHVybiBvcGVuQnJhY2tldHNbY2xvc2VCcmFja2V0XTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDbG9zZUJyYWNrZXQob3BlbkJyYWNrZXQ6IHN0cmluZykge1xyXG5cdGNvbnN0IGNsb3NlQnJhY2tldHM6e1tvcGVuQnJhY2tldDogc3RyaW5nXTogc3RyaW5nfSA9IHtcIihcIjogXCIpXCIsIFwiW1wiOiBcIl1cIiwgXCJ7XCI6IFwifVwifTtcclxuXHJcblx0cmV0dXJuIGNsb3NlQnJhY2tldHNbb3BlbkJyYWNrZXRdO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGVudW0gRGlyZWN0aW9uIHtcclxuXHRCYWNrd2FyZCxcclxuXHRGb3J3YXJkLFxyXG59XHJcblxyXG4vKipcclxuICAqIFNlYXJjaGVzIGZvciBhIHRva2VuIGluIHNpYmxpbmdzIGFuZCBwYXJlbnRzLCBpbiBvbmx5IG9uZSBkaXJlY3Rpb24uXHJcbiAgKlxyXG4gICogQHBhcmFtIGN1cnNvcjogV2hlcmUgdG8gc3RhcnQgaXRlcmF0aW9uXHJcbiAgKiBAcGFyYW0gZGlyOiBJbiB3aGljaCBkaXJlY3Rpb24gdG8gbG9vayBmb3IgdGhlIHRhcmdldCBub2RlXHJcbiAgKiBAcGFyYW0gdGFyZ2V0OiBXaGF0IHN1YnN0cmluZyB0aGUgdGFyZ2V0IG5vZGUgc2hvdWxkIGhhdmVcclxuICAqXHJcbiAgKiBAcmV0dXJucyBUaGUgbm9kZSBmb3VuZCBvciBudWxsIGlmIG5vbmUgd2FzIGZvdW5kLlxyXG4gICovXHJcbmV4cG9ydCBmdW5jdGlvbiBlc2NhbGF0ZVRvVG9rZW4oY3Vyc29yOiBUcmVlQ3Vyc29yLCBkaXI6IERpcmVjdGlvbiwgdGFyZ2V0OiBzdHJpbmcpOiBTeW50YXhOb2RlIHwgbnVsbCB7XHJcblx0Ly8gQWxsb3cgdGhlIHN0YXJ0aW5nIG5vZGUgdG8gYmUgYSBtYXRjaFxyXG5cdGlmIChjdXJzb3IubmFtZS5jb250YWlucyh0YXJnZXQpKSB7XHJcblx0XHRyZXR1cm4gY3Vyc29yLm5vZGU7XHJcblx0fVxyXG5cclxuXHR3aGlsZSAoXHJcblx0XHQoY3Vyc29yLm5hbWUgIT0gXCJEb2N1bWVudFwiKSAmJlxyXG5cdFx0KChkaXIgPT0gRGlyZWN0aW9uLkJhY2t3YXJkICYmIGN1cnNvci5wcmV2KCkpXHJcblx0XHR8fCAoZGlyID09IERpcmVjdGlvbi5Gb3J3YXJkICYmIGN1cnNvci5uZXh0KCkpXHJcblx0XHR8fCBjdXJzb3IucGFyZW50KCkpXHJcblx0KSB7XHJcblx0XHRpZiAoY3Vyc29yLm5hbWUuY29udGFpbnModGFyZ2V0KSkge1xyXG5cdFx0XHRyZXR1cm4gY3Vyc29yLm5vZGU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gbnVsbDtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiB0aGUgdXNlciBpcyB0eXBpbmcgaW4gYW4gSU1FIGNvbXBvc2l0aW9uLlxyXG4gKiBSZXR1cm5zIHRydWUgZXZlbiBpZiB0aGUgZ2l2ZW4gZXZlbnQgaXMgdGhlIGZpcnN0IGtleWRvd24gZXZlbnQgb2YgYW4gSU1FIGNvbXBvc2l0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tcG9zaW5nKHZpZXc6IEVkaXRvclZpZXcsIGV2ZW50OiBLZXlib2FyZEV2ZW50KTogYm9vbGVhbiB7XHJcblx0Ly8gdmlldy5jb21wb3NpbmcgYW5kIGV2ZW50LmlzQ29tcG9zaW5nIGFyZSBmYWxzZSBmb3IgdGhlIGZpcnN0IGtleWRvd24gZXZlbnQgb2YgYW4gSU1FIGNvbXBvc2l0aW9uLFxyXG5cdC8vIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIGV2ZW50LmtleUNvZGUgPT09IDIyOSB0byBwcmV2ZW50IElNRSBmcm9tIHRyaWdnZXJpbmcga2V5ZG93biBldmVudHMuXHJcblx0Ly8gTm90ZSB0aGF0IGtleUNvZGUgaXMgZGVwcmVjYXRlZCAtIGl0IGlzIHVzZWQgaGVyZSBiZWNhdXNlIGl0IGlzIGFwcGFyZW50bHkgdGhlIG9ubHkgd2F5IHRvIGRldGVjdCB0aGUgZmlyc3Qga2V5ZG93biBldmVudCBvZiBhbiBJTUUgY29tcG9zaXRpb24uXHJcblx0cmV0dXJuIHZpZXcuY29tcG9zaW5nIHx8IGV2ZW50LmtleUNvZGUgPT09IDIyOTtcclxufVxyXG4iXX0=