import { Decoration, } from "@codemirror/view";
export class RtlForc {
    decorations;
    constructor(view) {
        this.decorations = this.computeDecorations(view);
    }
    update(update) {
        if (update.docChanged || update.viewportChanged) {
            this.decorations = this.computeDecorations(update.view);
        }
    }
    computeDecorations(view) {
        const widgets = [];
        for (let { from, to } of view.visibleRanges) {
            for (let pos = from; pos <= to;) {
                const line = view.state.doc.lineAt(pos);
                const content = line.text.trim();
                if (content
                    .replace(/[#:\s"=-\d\[\].\+\-]*/g, "")
                    .replace(/<[a-z]+[\w\s\d]*>/g, "")
                    .match(/^[א-ת]/)) {
                    widgets.push(Decoration.line({
                        class: "custom-rtl-line",
                    }).range(line.from));
                }
                pos = line.to + 1;
            }
        }
        return Decoration.set(widgets);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdG9yRGVjb3JhdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZWRpdG9yRGVjb3JhdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUEyQixVQUFVLEdBQUcsTUFBTSxrQkFBa0IsQ0FBQztBQUd4RSxNQUFNLE9BQU8sT0FBTztJQUNoQixXQUFXLENBQXVCO0lBRWxDLFlBQVksSUFBZ0I7UUFDeEIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUVELE1BQU0sQ0FBQyxNQUFrQjtRQUNyQixJQUFJLE1BQU0sQ0FBQyxVQUFVLElBQUksTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ2xELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4RCxDQUFDO0lBQ0wsQ0FBQztJQUVELGtCQUFrQixDQUFDLElBQWdCO1FBQy9CLE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUNuQixLQUFLLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQzlDLEtBQUssSUFBSSxHQUFHLEdBQUcsSUFBSSxFQUFFLEdBQUcsSUFBSSxFQUFFLEdBQUksQ0FBQztnQkFDL0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUN4QyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO2dCQUNqQyxJQUNBLE9BQU87cUJBQ0YsT0FBTyxDQUFDLHdCQUF3QixFQUFFLEVBQUUsQ0FBQztxQkFDckMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLEVBQUUsQ0FBQztxQkFDakMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxFQUNsQixDQUFDO29CQUNILE9BQU8sQ0FBQyxJQUFJLENBQ1IsVUFBVSxDQUFDLElBQUksQ0FBQzt3QkFDaEIsS0FBSyxFQUFFLGlCQUFpQjtxQkFDdkIsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQ3RCLENBQUM7Z0JBQ0YsQ0FBQztnQkFDRCxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDdEIsQ0FBQztRQUNELENBQUM7UUFDRCxPQUFPLFVBQVUsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDbkMsQ0FBQztDQUNBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRWRpdG9yVmlldywgIFZpZXdVcGRhdGUgLERlY29yYXRpb24sIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcclxuaW1wb3J0IHsgUmFuZ2VTZXQgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivc3RhdGVcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBSdGxGb3JjIHtcclxuICAgIGRlY29yYXRpb25zOiBSYW5nZVNldDxEZWNvcmF0aW9uPjtcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IodmlldzogRWRpdG9yVmlldykge1xyXG4gICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmNvbXB1dGVEZWNvcmF0aW9ucyh2aWV3KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xyXG4gICAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkKSB7XHJcbiAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuY29tcHV0ZURlY29yYXRpb25zKHVwZGF0ZS52aWV3KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbXB1dGVEZWNvcmF0aW9ucyh2aWV3OiBFZGl0b3JWaWV3KTogUmFuZ2VTZXQ8RGVjb3JhdGlvbj4ge1xyXG4gICAgICAgIGNvbnN0IHdpZGdldHMgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCB7IGZyb20sIHRvIH0gb2Ygdmlldy52aXNpYmxlUmFuZ2VzKSB7XHJcbiAgICAgICAgZm9yIChsZXQgcG9zID0gZnJvbTsgcG9zIDw9IHRvOyApIHtcclxuICAgICAgICAgICAgY29uc3QgbGluZSA9IHZpZXcuc3RhdGUuZG9jLmxpbmVBdChwb3MpO1xyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gbGluZS50ZXh0LnRyaW0oKTtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBjb250ZW50XHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvWyM6XFxzXCI9LVxcZFxcW1xcXS5cXCtcXC1dKi9nLCBcIlwiKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoLzxbYS16XStbXFx3XFxzXFxkXSo+L2csIFwiXCIpXHJcbiAgICAgICAgICAgICAgICAubWF0Y2goL15b15At16pdLylcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHdpZGdldHMucHVzaChcclxuICAgICAgICAgICAgICAgIERlY29yYXRpb24ubGluZSh7XHJcbiAgICAgICAgICAgICAgICBjbGFzczogXCJjdXN0b20tcnRsLWxpbmVcIixcclxuICAgICAgICAgICAgICAgIH0pLnJhbmdlKGxpbmUuZnJvbSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwb3MgPSBsaW5lLnRvICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBEZWNvcmF0aW9uLnNldCh3aWRnZXRzKTtcclxuICAgIH1cclxuICAgIH0iXX0=