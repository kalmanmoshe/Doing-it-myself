import { Decoration, } from "@codemirror/view";
export class RtlForc {
    decorations;
    constructor(view) {
        this.decorations = this.computeDecorations(view);
    }
    update(update) {
        if (update.docChanged || update.viewportChanged) {
            this.decorations = this.computeDecorations(update.view);
        }
    }
    computeDecorations(view) {
        const widgets = [];
        for (let { from, to } of view.visibleRanges) {
            for (let pos = from; pos <= to;) {
                const line = view.state.doc.lineAt(pos);
                const content = line.text.trim();
                if (content
                    .replace(/[#:\s"=-\d\[\].\+\-]*/g, "")
                    .replace(/<[a-z]+[\w\s\d]*>/g, "")
                    .match(/^[א-ת]/)) {
                    widgets.push(Decoration.line({
                        class: "custom-rtl-line",
                    }).range(line.from));
                }
                pos = line.to + 1;
            }
        }
        return Decoration.set(widgets);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdG9yRGVjb3JhdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZWRpdG9yRGVjb3JhdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUEyQixVQUFVLEdBQUcsTUFBTSxrQkFBa0IsQ0FBQztBQUd4RSxNQUFNLE9BQU8sT0FBTztJQUNoQixXQUFXLENBQXVCO0lBRWxDLFlBQVksSUFBZ0I7UUFDeEIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUVELE1BQU0sQ0FBQyxNQUFrQjtRQUNyQixJQUFJLE1BQU0sQ0FBQyxVQUFVLElBQUksTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ2xELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4RCxDQUFDO0lBQ0wsQ0FBQztJQUVELGtCQUFrQixDQUFDLElBQWdCO1FBQy9CLE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUNuQixLQUFLLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQzlDLEtBQUssSUFBSSxHQUFHLEdBQUcsSUFBSSxFQUFFLEdBQUcsSUFBSSxFQUFFLEdBQUksQ0FBQztnQkFDL0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUN4QyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO2dCQUNqQyxJQUNBLE9BQU87cUJBQ0YsT0FBTyxDQUFDLHdCQUF3QixFQUFFLEVBQUUsQ0FBQztxQkFDckMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLEVBQUUsQ0FBQztxQkFDakMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxFQUNsQixDQUFDO29CQUNILE9BQU8sQ0FBQyxJQUFJLENBQ1IsVUFBVSxDQUFDLElBQUksQ0FBQzt3QkFDaEIsS0FBSyxFQUFFLGlCQUFpQjtxQkFDdkIsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQ3RCLENBQUM7Z0JBQ0YsQ0FBQztnQkFDRCxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDdEIsQ0FBQztRQUNELENBQUM7UUFDRCxPQUFPLFVBQVUsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDbkMsQ0FBQztDQUNBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRWRpdG9yVmlldywgIFZpZXdVcGRhdGUgLERlY29yYXRpb24sIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IFJhbmdlU2V0IH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XG5cbmV4cG9ydCBjbGFzcyBSdGxGb3JjIHtcbiAgICBkZWNvcmF0aW9uczogUmFuZ2VTZXQ8RGVjb3JhdGlvbj47XG4gICAgXG4gICAgY29uc3RydWN0b3IodmlldzogRWRpdG9yVmlldykge1xuICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gdGhpcy5jb21wdXRlRGVjb3JhdGlvbnModmlldyk7XG4gICAgfVxuICAgIFxuICAgIHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcbiAgICAgICAgaWYgKHVwZGF0ZS5kb2NDaGFuZ2VkIHx8IHVwZGF0ZS52aWV3cG9ydENoYW5nZWQpIHtcbiAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuY29tcHV0ZURlY29yYXRpb25zKHVwZGF0ZS52aWV3KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb21wdXRlRGVjb3JhdGlvbnModmlldzogRWRpdG9yVmlldyk6IFJhbmdlU2V0PERlY29yYXRpb24+IHtcbiAgICAgICAgY29uc3Qgd2lkZ2V0cyA9IFtdO1xuICAgICAgICBmb3IgKGxldCB7IGZyb20sIHRvIH0gb2Ygdmlldy52aXNpYmxlUmFuZ2VzKSB7XG4gICAgICAgIGZvciAobGV0IHBvcyA9IGZyb207IHBvcyA8PSB0bzsgKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gdmlldy5zdGF0ZS5kb2MubGluZUF0KHBvcyk7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gbGluZS50ZXh0LnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvWyM6XFxzXCI9LVxcZFxcW1xcXS5cXCtcXC1dKi9nLCBcIlwiKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC88W2Etel0rW1xcd1xcc1xcZF0qPi9nLCBcIlwiKVxuICAgICAgICAgICAgICAgIC5tYXRjaCgvXlvXkC3Xql0vKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICB3aWRnZXRzLnB1c2goXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5saW5lKHtcbiAgICAgICAgICAgICAgICBjbGFzczogXCJjdXN0b20tcnRsLWxpbmVcIixcbiAgICAgICAgICAgICAgICB9KS5yYW5nZShsaW5lLmZyb20pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcG9zID0gbGluZS50byArIDE7XG4gICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRGVjb3JhdGlvbi5zZXQod2lkZ2V0cyk7XG4gICAgfVxuICAgIH0iXX0=